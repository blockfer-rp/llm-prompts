Please continue with the following PLAN phases:

$ARGUMENT

- Ensure to keep all existing functionality and follow the same patterns and framework, including concise docstrings that explain the framework to help future engineers maintain the code.
- Return the FULL source code of all modules to update with the new updates. Ensure to keep all core requirements and attributes.
- Do NOT keep backward compatibility, legacy methods, or fallback functions!
- Return the full source code, production-ready, of Implementation Plan.
- Ensure that the code is complete, with no placeholders or partial updates.
- The goal is to fix fundamental architectural issues.
- Do NOT add new features that are not part of the original core requirements.

**MANDATORY:**  
- 100% function/method/variable coverage: retain all code from the original unless specifically told to remove.
- NO placeholders or “simulate”/“stub” comments.  
- Provide a full function inventory checklist for each file touched, detailing what stayed the same, what changed, and what is missing—with explicit justification.
